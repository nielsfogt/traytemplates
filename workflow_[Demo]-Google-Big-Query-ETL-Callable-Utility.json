 {
  "tray_export_version": 4,
  "export_type": "workflow",
  "workflows": [
    {
      "id": "136d3e58-c6d9-40dd-820d-062720021aba",
      "created": "2021-10-17T16:12:07.966Z",
      "workspace_id": "7de0221f-ff95-4544-803a-ae288b50c77e",
      "creator": "7de0221f-ff95-4544-803a-ae288b50c77e",
      "version": {
        "id": "74421ea9-e044-4268-bf0c-2aaebfbe1eef",
        "created": "2021-10-17T16:20:07.743Z"
      },
      "title": "[Demo] Google Big Query ETL - Callable Utility",
      "enabled": true,
      "tags": [],
      "settings": {
        "config": {},
        "input_schema": {
          "type": "object",
          "properties": {
            "data": {
              "title": "Data",
              "description": "Is the array of data you wish to insert into BigQuery",
              "type": "array",
              "items": {
                "type": "string",
                "title": "Item"
              },
              "additionalItems": true
            },
            "keyMappings": {
              "title": "Key Mappings",
              "type": "array",
              "items": {
                "title": "Mapping",
                "type": "object",
                "properties": {
                  "from": {
                    "type": "string",
                    "title": "From"
                  },
                  "to": {
                    "title": "To",
                    "type": "string"
                  }
                },
                "additionalProperties": false,
                "required": [],
                "advanced": []
              },
              "additionalItems": true
            },
            "batchSize": {
              "title": "Batch Size",
              "type": "integer",
              "default": 500
            }
          },
          "additionalProperties": false,
          "required": [],
          "advanced": []
        },
        "output_schema": {
          "type": "object",
          "properties": {
            "Batches": {
              "title": "Batches",
              "type": "array",
              "items": {
                "title": "Batch",
                "type": "array",
                "items": {
                  "type": "string",
                  "title": "Item"
                },
                "additionalItems": true
              },
              "additionalItems": true
            }
          },
          "additionalProperties": false,
          "required": [],
          "advanced": []
        }
      },
      "steps_structure": [
        {
          "name": "trigger",
          "type": "normal",
          "content": {}
        },
        {
          "name": "loop-1",
          "type": "loop",
          "content": {
            "_loop": [
              {
                "name": "data-mapper-1",
                "type": "normal",
                "content": {}
              },
              {
                "name": "storage-1",
                "type": "normal",
                "content": {}
              }
            ]
          }
        },
        {
          "name": "storage-2",
          "type": "normal",
          "content": {}
        },
        {
          "name": "list-helpers-1",
          "type": "normal",
          "content": {}
        },
        {
          "name": "callable-workflow-response-1",
          "type": "normal",
          "content": {}
        }
      ],
      "steps": {
        "data-mapper-1": {
          "title": "Map keys to bigQuery columns",
          "connector": {
            "name": "data-mapper",
            "version": "3.5"
          },
          "operation": "map_keys",
          "output_schema": {},
          "error_handling": {},
          "properties": {
            "object1": {
              "type": "jsonpath",
              "value": "$.steps.loop-1.value"
            },
            "mappings": {
              "type": "jsonpath",
              "value": "$.steps.trigger.data.keyMappings"
            }
          }
        },
        "storage-2": {
          "title": "Get our list",
          "connector": {
            "name": "storage",
            "version": "1.4"
          },
          "operation": "get",
          "output_schema": {
            "$schema": "http://json-schema.org/draft-04/schema#",
            "type": "object",
            "properties": {
              "value": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "wasHam": {
                          "type": "boolean"
                        },
                        "ID": {
                          "type": "number"
                        }
                      }
                    }
                  },
                  "required": [
                    "data"
                  ]
                }
              }
            }
          },
          "error_handling": {},
          "properties": {
            "scope": {
              "type": "string",
              "value": "Current Run"
            },
            "key": {
              "type": "string",
              "value": "data"
            },
            "default_value": {
              "type": "null",
              "value": null
            }
          }
        },
        "callable-workflow-response-1": {
          "title": "Callable response",
          "connector": {
            "name": "callable-workflow-response",
            "version": "1.0"
          },
          "operation": "response",
          "output_schema": {},
          "error_handling": {},
          "properties": {
            "response": {
              "value": {
                "Batches": {
                  "type": "jsonpath",
                  "value": "$.steps.list-helpers-1.result"
                }
              },
              "type": "object"
            }
          }
        },
        "loop-1": {
          "title": "For each row of data",
          "connector": {
            "name": "loop",
            "version": "1.1"
          },
          "operation": "loop_array",
          "output_schema": {
            "type": "object",
            "$schema": "http://json-schema.org/draft-03/schema",
            "id": "http://jsonschema.net",
            "required": true,
            "additionalProperties": false,
            "properties": {
              "value": {},
              "count": {
                "type": "number",
                "id": "http://jsonschema.net/total"
              },
              "index": {
                "type": "number",
                "id": "http://jsonschema.net/index"
              },
              "is_first": {
                "type": "boolean",
                "id": "http://jsonschema.net/is_first"
              },
              "is_last": {
                "type": "boolean",
                "id": "http://jsonschema.net/is_last"
              }
            }
          },
          "error_handling": {},
          "properties": {
            "array": {
              "type": "jsonpath",
              "value": "$.steps.trigger.data.data"
            }
          }
        },
        "list-helpers-1": {
          "title": "Create batches",
          "connector": {
            "name": "list-helpers",
            "version": "2.1"
          },
          "operation": "chunk",
          "output_schema": {},
          "error_handling": {},
          "properties": {
            "list": {
              "type": "jsonpath",
              "value": "$.steps.storage-2.value"
            },
            "size": {
              "type": "jsonpath",
              "value": "$.steps.trigger.data.batchSize"
            }
          }
        },
        "storage-1": {
          "title": "Save item in list",
          "connector": {
            "name": "storage",
            "version": "1.4"
          },
          "operation": "append_to_list",
          "output_schema": {},
          "error_handling": {},
          "properties": {
            "scope": {
              "type": "string",
              "value": "Current Run"
            },
            "key": {
              "type": "string",
              "value": "data"
            },
            "create_if_missing": {
              "type": "boolean",
              "value": true
            },
            "value": {
              "type": "object",
              "value": {
                "data": {
                  "type": "jsonpath",
                  "value": "$.steps.data-mapper-1"
                }
              }
            }
          }
        },
        "trigger": {
          "title": "Callable Trigger",
          "connector": {
            "name": "callable-trigger",
            "version": "2.0"
          },
          "operation": "trigger_and_respond",
          "output_schema": {},
          "error_handling": {},
          "properties": {}
        }
      },
      "dependencies": []
    }
  ],
  "projects": []
}